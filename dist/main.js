(()=>{"use strict";const t=t=>{let e=a(t,{x:0,y:0});return{x:t.x/e,y:t.y/e}},e=(t,e)=>t.x*e.x+t.y*e.y,s=t=>a(t,{x:0,y:0}),i=(t,i)=>e(t,i)/(s(t)*s(i)),h=(t,e)=>({x:t.x*e,y:t.y*e}),a=(t,e)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2),o=t=>Math.floor(Math.random()*t),r=t=>({87:{x:0,y:1},65:{x:1,y:0},83:{x:0,y:-1},68:{x:-1,y:0},155:{x:-.866,y:.5},152:{x:.866,y:.5},151:{x:-.866,y:-.5},148:{x:.866,y:-.5},0:{x:0,y:0}}[t]),l=t=>87===t||83===t?.577:65===t||68===t?1:s({x:.707,y:.408});class c{constructor({pos:t,delta:e,normal:s}){this.pos=t,t||(this.pos={x:0,y:0}),this.delta=e,e||(this.delta={x:50,y:50}),this.normal=s}distToObj(t){let i=this.pos,a=this.delta,o={x:t.pos.x-i.x,y:t.pos.y-i.y},r=e(o,a)/s(a)**2,l=h({x:a.x,y:a.y},r);return s({x:t.pos.x-(l.x+i.x),y:t.pos.y-(l.y+i.y)})}draw(t){let e=this.pos,s=this.delta;t.strokeStyle="yellow",t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(e.x+s.x,e.y+s.y),t.stroke()}}class n{constructor({vel:t,pos:e,r:s,img:i,color:h}){this.vel=t||{x:0,y:0},this.pos=e||{x:0,y:0},this.r=s||20,this.color=h||"white",this.img=i,i&&(this.anchor={x:this.pos.x-this.img.width/2,y:this.pos.y-this.img.height/2})}draw(t){this.img?(this._updateAnchor(),t.drawImage(this.img,this.anchor.x,this.anchor.y)):(t.fillStyle=this.color,t.beginPath(),t.arc(this.pos.x,this.pos.y,this.r,0,2*Math.PI),t.fill())}_updateAnchor(){this.anchor={x:this.pos.x-this.img.width/2,y:this.pos.y-this.img.height/2}}move(t){this.pos.x+=this.vel.x*t,this.pos.y+=this.vel.y*t}}class d extends n{constructor({vel:t,pos:e,r:s,owner:i,dir:h}){super({vel:t,pos:e,r:s}),this.owner=i,this.dir=h}draw(t){t.fillStyle="red",t.beginPath(),t.arc(this.pos.x,this.pos.y,this.r,0,2*Math.PI),t.fill()}}class p{constructor(t,e,s){this.pos=t,this.scene=e,this.type=s?"block":"hit",this.setSprite(`${this.type}_1`),this.img&&(this.anchor={x:this.pos.x-this.img.width/2,y:this.pos.y-this.img.height/2}),this.scene.addEffect(this),this.timeSpawned=Date.now()}draw(t){let e=Date.now()-this.timeSpawned;e<100?(this.setSprite(`${this.type}_1`),t.drawImage(this.img,this.anchor.x,this.anchor.y)):e<200?(this.setSprite(`${this.type}_2`),t.drawImage(this.img,this.anchor.x,this.anchor.y)):e<300?(this.setSprite(`${this.type}_3`),t.drawImage(this.img,this.anchor.x,this.anchor.y)):this.scene.removeEffect(this)}setSprite(t){this.img=effectSprites[t]}}class y extends n{constructor({vel:t,pos:e,r:s,health:i,speed:h,img:a,dir:o,state:r},l){super({vel:t,pos:e,r:s,img:a}),this.health=i||5,this.speed=h||60,this.dir=o||148,this.state=r||"idle",this.stateLock=!1,this.timeEnteredState=new Date,this.scene=l,this.hitbox=void 0,this.hitBy=void 0,this.timeHit=void 0,this.states={idle:["attack","moving","death"],attack:["idle","death"],moving:["idle","attack","death"],death:[]}}tick(t){switch(this.state){case"idle":this.idle();break;case"attack":this.attack();break;case"moving":this.moving();break;case"death":this.death()}this.hitBy&&this._hit(t)}changeState(t){this.stateLock&&"death"!==t||this.states[this.state].includes(t)&&(this.hitbox&&(this.scene.removeHitbox(this.hitbox),this.hitbox=void 0),this.state=t,this.timeEnteredState=new Date)}idle(){}attack(){}moving(){}death(){}hit(t){this.hitBy||(this.hitBy=t,this.timeHit=Date.now(),this.blockCheck(t))}blockCheck(t){this.health>0&&this.health--,this.addHitEffect(t)}addHitEffect(t){let e=h(r(t.dir),20);new p({x:e.x+this.pos.x,y:e.y+this.pos.y},this.scene,!1),this.scene.sound&&new Audio("../assets/sounds/hit1.wav").play()}_hit(t){let e=Date.now()-this.timeHit;e<400?(this.pushBack(400-e,t),this.color="red"):(this.vel={x:0,y:0},this.hitBy=void 0,this.color="white")}pushBack(t,e){let s=r(this.hitBy.dir);s=h(s,-1),this.pos.x+=s.x*t*e,this.pos.y+=s.y*t*e}createHitbox(t=1.2){let e=this.r*t,s=h(r(this.dir),(e+this.r+4)*l(this.dir)*-1);return new d({pos:{x:this.pos.x+s.x,y:this.pos.y+s.y},r:e,owner:this,dir:this.dir})}collisionHandle(t){let e=Math.abs(t.distToObj(this)-this.r),s=h({x:t.normal.x,y:t.normal.y},-1*e);this.pos.x+=s.x,this.pos.y+=s.y}disperse(){}}class x extends y{constructor(t,e){super({vel:{x:0,y:0},pos:t,r:40,img:void 0,health:3,speed:60,state:"moving"},e),this.player=this.scene.player,this.absoluteSpeed=this.speed,this.velVector={x:0,y:0},setInterval((()=>{this.stateLock||(this._setDirFromAngle(),this._setVelAndSpeed())}),500)}tick(t){this.health<=0&&this.changeState("death"),this.setSprite("idle"),super.tick(t)}idle(){this.stateLock=!1,a(this.player.pos,this.pos)<120?this.changeState("attack"):this.changeState("moving")}attack(){this._setDirFromAngle(),this.stateLock=!0,this.vel={x:0,y:0};let t=Date.now()-this.timeEnteredState;t<400?(this.setSprite("attack_1"),this.color="white",this.scene.sound&&(this.attackSoundPlayed||(this.attackSoundPlayed=!0,new Audio("../assets/sounds/attack2.wav").play()))):t<800?(this.setSprite("attack_2"),this.hitbox||(this.hitbox=this.createHitbox(),this.scene.addHitbox(this.hitbox))):t<1e3?(this.setSprite("attack_3"),this.hitbox&&(this.scene.removeHitbox(this.hitbox),this.hitbox=void 0)):t<1200?this.setSprite("attack_4"):(this.stateLock=!1,this.color="green",this.changeState("idle"),this.attackSoundPlayed=void 0)}death(){let t=Date.now()-this.timeEnteredState;this.stateLock=!0,this.color="black",t<600?this.setSprite("death_1"):t<800?this.setSprite("death_2"):t<1e3?this.setSprite("death_3"):t<1200?this.setSprite("death_4"):(this.scene.removeGameObject(this),this.scene.score+=200,this.player.killCount++)}moving(){this.stateLock=!1;let t=(Date.now()-this.timeEnteredState)%800;t<400?this.setSprite("idle"):t<600?this.setSprite("move_1"):t<800&&this.setSprite("move_2"),this.vel.x=this.velVector.x*this.speed,this.vel.y=this.velVector.y*this.speed,a(this.player.pos,this.pos)<120&&this.changeState("attack")}setSprite(t){this.img=enemySprites[this.dir][t]}_setVelAndSpeed(){this.velVector=h(r(this.dir),-1),this.speed=this.absoluteSpeed*l(this.dir)}_setDirFromAngle(){if(this.stateLock)return;let e=t({x:this.player.pos.x-this.pos.x,y:this.player.pos.y-this.pos.y}),s=i(e,{x:0,y:-1}),a=2;e.x<0?[87,152,65,148,83].forEach((t=>{let e=h(r(t),-1),o=i(e,{x:0,y:-1}),l=Math.abs(o-s);l<a&&(a=l,this.dir=t)})):[87,155,68,151,83].forEach((t=>{let e=h(r(t),-1),o=i(e,{x:0,y:-1}),l=Math.abs(o-s);l<a&&(a=l,this.dir=t)}))}disperse(e,s){let i=Math.abs(a(e.pos,this.pos)-(e.r+this.r-s)),o=h(t({x:this.pos.x-e.pos.x,y:this.pos.y-e.pos.y}),i),r=h(o,-1);this.pos.x+=o.x,this.pos.y+=o.y,e.pos.x+=r.x,e.pos.y+=r.y}}class m extends y{constructor(t,e){super({vel:{x:0,y:0},pos:t,r:40,img:playerSprites[148].idle,health:5,speed:400,color:"white"},e),this.mockPush={x:0,y:0},this.collisionCorrection={x:0,y:0},this.unscaledSpeed=this.speed,this.strafe=!1,this.potions=3,this.killCount=0,this.states={idle:["attack","moving","death","heal"],attack:["idle","death"],moving:["idle","attack","death","heal"],death:[],heal:["idle","death"]}}blocking(){return("idle"===this.state||"moving"===this.state)&&this.strafe}tick(t){super.tick(t),"heal"===this.state&&this.heal(),this.strafe&&(this.speed=.3*this.unscaledSpeed)}idle(){this.stateLock=!1,this.setSprite("idle"),this.strafe&&this.setSprite("strafe_1")}heal(){this.stateLock=!0;let t=Date.now()-this.timeEnteredState;t<800?this.setSprite("heal_1"):t<900?(this.usedPotion||(this.usedPotion=!0,this.usePotion()),this.setSprite("heal_2")):t<1e3?this.setSprite("heal_3"):t<1200?this.setSprite("heal_4"):(this.usedPotion=void 0,this.stateLock=!1,this.changeState("idle"))}attack(){let t=Date.now()-this.timeEnteredState;this.stateLock=!0,t<200?(this.setSprite("attack_1"),this.hitbox||(this.scene.sound&&sounds.attack1.play(),this.hitbox=this.createHitbox(),this.scene.addHitbox(this.hitbox))):t<300?this.setSprite("attack_2"):t<400?(this.setSprite("attack_3"),this.hitbox&&(this.scene.removeHitbox(this.hitbox),this.hitbox=void 0)):(this.stateLock=!1,this.changeState("idle"))}hit(t){super.hit(t),this.health<=0&&this.scene.endGame()}blockCheck(t){this.blocking()&&((t,e)=>{let s=!1;switch(t){case 87:s=[83,151,148].includes(e);break;case 155:s=[65,83,148].includes(e);break;case 68:s=[65,148,152].includes(e);break;case 151:s=[152,87,65].includes(e);break;case 83:s=[87,155,152].includes(e);break;case 148:s=[155,87,68].includes(e);break;case 65:s=[68,155,151].includes(e);break;case 152:s=[151,83,68].includes(e)}return s})(this.dir,t.dir)?(this.addHitEffect(t,!0),this.successfulBlock=!0):(this.health>0&&this.health--,this.addHitEffect(t,!1),this.successfulBlock=void 0)}addHitEffect(t,e){let s=h(r(t.dir),20);new p({x:s.x+this.pos.x,y:s.y+this.pos.y},this.scene,e),this.scene.sound&&(e||new Audio("../assets/sounds/hit1.wav").play())}_hit(t){let e=Date.now()-this.timeHit;e<400?(this.pushBack(400-e,t),this.successfulBlock||(this.color="red"),this.img.style.opacity=0):(this.mockPush={x:0,y:0},this.hitBy=void 0,this.color="white")}pushBack(t,e){let s=r(this.hitBy.dir);s=h(s,-1),this.mockPush.x=s.x*t*e*-1,this.mockPush.y=s.y*t*e*-1}moving(){this.speed=this.unscaledSpeed*l(this.dir),this.stateLock=!1;let t=(Date.now()-this.timeEnteredState)%800;t<200?(this.setSprite("move_1"),this.strafe&&this.setSprite("strafe_3")):t<400?(this.setSprite("move_2"),this.strafe&&this.setSprite("strafe_2")):t<600?(this.setSprite("move_3"),this.strafe&&this.setSprite("strafe_1")):(this.setSprite("move_4"),this.strafe&&this.setSprite("strafe_2"))}death(){}addHealth(t){this.health+=t,this.health>=5&&(this.health=5)}addPotion(){this.potions++,this.potions>=3&&(this.potions=3)}usePotion(){this.potions>0&&(this.addHealth(3),this.potions--)}collisionHandle(t){let e=Math.abs(t.distToObj(this)-this.r),s=h({x:t.normal.x,y:t.normal.y},e);this.collisionCorrection.x+=s.x,this.collisionCorrection.y+=s.y}setSprite(t){this.img=playerSprites[this.dir][t]}}class f{constructor({pos:t},e){this.pos=t,t||(this.pos={x:0,y:0}),this.scene=e,this.spawning=!1,this.enemy=void 0}tick(t){if(this.spawning){let t=Date.now()-this.timeActivated;t<200?this.setSprite("spawn_3"):t<400?this.setSprite("spawn_2"):t<600?this.setSprite("spawn_1"):t<700?this.enemy||(this.enemy=new x({x:this.pos.x,y:this.pos.y},this.scene),this.scene.addGameObject(this.enemy)):t<800?this.setSprite("spawn_2"):t<1e3?this.setSprite("spawn_3"):(this.img=void 0,this.spawning=!1,this.enemy=void 0)}}spawnEnemy(){this.timeActivated=Date.now(),this.spawning=!0}setSprite(t){this.img=effectSprites[t]}draw(t){this.img&&t.drawImage(this.img,this.pos.x-this.img.width/2,this.pos.y-this.img.height/2)}}class g{constructor(t){this.scene=t,this.dim={x:this.scene.game.dimx,y:this.scene.game.dimy},this.player=this.scene.player}draw(t){if(this.scene.gameOver)return void this._gameOverScreen(t);let e=this.dim,s=40,i=`Health: ${this.player.health}`,h=`Score: ${this.scene.score}`,a=`Potions: ${this.player.potions}`;t.font="italic 40px Times New Roman",t.textAlign="left",t.strokeStyle="black",t.lineWidth=4,t.fillStyle=this.player.color,t.strokeText(i,s,50),t.fillText(i,s,50),t.fillStyle="white",t.strokeText(a,s,100),t.fillText(a,s,100),t.strokeText(h,s,e.y-50),t.fillText(h,s,e.y-50)}_gameOverScreen(t){this._shadowOverlay(t);let e=this.dim,s=80;t.font=`italic ${s}px Times New Roman`,t.textAlign="center",t.strokeStyle="black",t.lineWidth=4,t.fillStyle="white";let i=e.y/2-40,h="GAME OVER";t.strokeText(h,e.x/2,i-40),t.fillText(h,e.x/2,i-40),s=40,t.font=`italic ${s}px Times New Roman`,t.strokeText("~",e.x/2,i),t.fillText("~",e.x/2,i);let a=`You scored ${this.scene.score} points`;t.strokeText(a,e.x/2,i+40),t.fillText(a,e.x/2,i+40);let o=`and defeated ${this.player.killCount} enemies.`;t.strokeText(o,e.x/2,i+100),t.fillText(o,e.x/2,i+100),s=30,t.font=`italic ${s}px Times New Roman`;let r="Press r to restart.";t.strokeText(r,e.x/2,i+160),t.fillText(r,e.x/2,i+160)}_shadowOverlay(t){let e=this.dim;t.globalAlpha=.5,t.fillStyle="black",t.fillRect(0,0,e.x,e.y),t.globalAlpha=1}}class u extends y{constructor(t,e){super({pos:t}),this.scene=e,this.img=bgSprites.totem_1}hit(t){this.whacked||(this.whacked=!0,this.scene.startGame(),this.img=bgSprites.totem_2),super.hit(t)}}class w{constructor(t,e){this.game=t,this.options=e,this.ctx=this.game.ctx,this.center=t.center,this.cameraDir=0,this.boundaries=[],this.spawnPoints=[],this.backgroundStatic=[],this.gameObjects=[],this.effects=[],this.hitboxes=[],this.player=new m(this.center,this),this.foregroundStatic=[],this.floorTileOffset={x:100,y:57},this.addBackgroundStatic(),this.addBoundaries(),this.addSpawnPoints(),this.gameStart=!1,this.gameOver=!1,this.score=0,this.sound=!1,this.hud=new g(this),this.gameObjects.push(new u({x:this.terrainOrigin.x+2*this.floorTileOffset.x,y:this.terrainOrigin.y+5*this.floorTileOffset.y},this))}run(t){this.gameOver?(key.getPressedKeyCodes().includes(82)&&(this.setScore(),this.game.restart()),this.drawObjects(this.ctx),this.drawHud(this.ctx)):(this.gameStart&&this.incrementScore(t),this.tickStateMachines(t),this.getInputs(),this.checkCollisions(),this.moveObjects(t),this.translateObjects(t),this.hitDetection(),this.drawObjects(this.ctx),this.drawHud(this.ctx))}startGame(){this.gameStart||(this.gameStart=!0,this.spawnInterval=setInterval((()=>{this.spawnPoints[o(this.spawnPoints.length)].spawnEnemy()}),2500))}endGame(){this.gameOver=!0,clearInterval(this.spawnInterval)}setScore(){let t=["s0","s1","s2","s3","s4","s5","s6","s7","s8","s9"],e=[];t.forEach((t=>{let s=localStorage.getItem(t);s&&e.push(parseInt(s))})),e.push(this.score),e.sort(((t,e)=>e-t)),e=e.slice(0,10);for(let s=0;s<e.length;s++)localStorage.setItem(t[s],e[s]);this.options.scoreBoardCallback()}addGameObject(t){this.gameObjects.includes(t)||this.gameObjects.push(t)}removeGameObject(t){this.gameObjects.splice(this.gameObjects.indexOf(t),1)}addHitbox(t){this.hitboxes.includes(t)||this.hitboxes.push(t)}removeHitbox(t){this.hitboxes.splice(this.hitboxes.indexOf(t),1)}addEffect(t){this.effects.includes(t)||this.effects.push(t)}removeEffect(t){this.effects.splice(this.effects.indexOf(t),1)}incrementScore(t){this.score+=Math.floor(100*t)}tickStateMachines(t){this.player.tick(t),[...this.gameObjects,...this.spawnPoints].forEach((e=>e.tick(t)))}getInputs(){let t=key.getPressedKeyCodes();this.processWasd(t),t.includes(74)&&this.player.changeState("attack"),t.includes(73)?this.player.strafe=!0:this.player.strafe=!1,t.includes(79)&&this.player.potions>0&&this.player.changeState("heal")}processWasd(t){let e=((t,e)=>{let s=new Set([87,65,83,68]),i=new Set(e),h=new Set([...s].filter((t=>i.has(t))));return Array.from(h)})(0,t).slice(0,2).reduce(((t,e)=>t+e),0);133!==e&&170!==e||(e=0),0===e||this.player.stateLock||this.player.strafe||(this.player.dir=e),0===e?this.player.changeState("idle"):this.player.changeState("moving"),"moving"===this.player.state?this.cameraDir=e:this.cameraDir=0}moveObjects(t){this.gameObjects.forEach((e=>{e.move(t)}))}translateObjects(t){let e=r(this.cameraDir),s=this.player.speed,i=h(e,s*t);i={x:i.x+this.player.mockPush.x+this.player.collisionCorrection.x,y:i.y+this.player.mockPush.y+this.player.collisionCorrection.y},this.player.collisionCorrection.x=0,this.player.collisionCorrection.y=0,[this.backgroundStatic,this.gameObjects,this.effects,this.hitboxes,this.spawnPoints,this.boundaries,this.foregroundStatic].forEach((t=>{t.forEach((t=>{t.pos.x+=i.x,t.pos.y+=i.y}))}))}hitDetection(){this.gameObjects.forEach((t=>{this.hitboxes.forEach((e=>{a(t.pos,e.pos)<t.r+e.r&&e.owner===this.player&&t.hit(e)}))})),this.hitboxes.forEach((t=>{a(this.player.pos,t.pos)<this.player.r+t.r&&t.owner!==this.player&&this.player.hit(t)}))}checkCollisions(){this.boundaries.forEach((t=>{this.gameObjects.forEach((e=>{t.distToObj(e)<e.r&&e.collisionHandle(t)})),t.distToObj(this.player)<this.player.r&&this.player.collisionHandle(t)}));for(let t=1;t<this.gameObjects.length;t++)for(let e=0;e<t;e++){let s=this.gameObjects[t],i=this.gameObjects[e];a(s.pos,i.pos)<s.r+i.r-20&&s.disperse(i,20)}}drawObjects(t){t.clearRect(0,0,this.game.dimx,this.game.dimy),t.fillStyle="black",t.fillRect(0,0,this.game.dimx,this.game.dimy),this.backgroundStatic.forEach((e=>{e.draw(t)}));let e=[...this.gameObjects,...this.spawnPoints,this.player];e=e.sort(((t,e)=>t.pos.y>e.pos.y?1:-1));for(let s=0;s<e.length;s++)e[s].draw(t);this.effects.forEach((e=>{e.draw(t)})),this.foregroundStatic.forEach((e=>{e.draw(t)}))}drawHud(t){this.hud.draw(t)}drawHitboxes(t){this.hitboxes.forEach((e=>{e.draw(t)}))}drawBoundaries(t){this.boundaries.forEach((e=>{e.draw(t)}))}drawSpawnPoints(t){this.spawnPoints.forEach((e=>{e.draw(t)}))}addBackgroundStatic(){let t=this.floorTileOffset,e={x:this.game.dimx/2,y:-2*t.y},s={x:e.x,y:e.y};for(let e=0;e<11;e++){let e=20*Math.random(),i=new n({pos:{x:s.x,y:s.y+e},img:bgSprites.wall0});this.backgroundStatic.push(i),i=new n({pos:{x:s.x,y:s.y-128+e},img:bgSprites.wall0}),this.backgroundStatic.push(i),s.x+=t.x,s.y+=t.y}let i={x:e.x-t.x,y:e.y+t.y};for(let e=0;e<10;e++){let e=20*Math.random(),s=new n({pos:{x:i.x,y:i.y+e},img:bgSprites.wall0});this.backgroundStatic.push(s),s=new n({pos:{x:i.x,y:i.y-128+e},img:bgSprites.wall0}),this.backgroundStatic.push(s),i.x-=t.x,i.y+=t.y}let h={x:this.game.dimx/2,y:0};this.terrainOrigin={x:h.x,y:h.y};let a={x:h.x,y:h.y};for(let e=0;e<10;e++){let e={x:a.x,y:a.y};for(let s=0;s<10;s++){let s=new n({pos:{x:e.x,y:e.y+20*Math.random()},img:bgSprites[`ground${o(2)}`]});this.backgroundStatic.push(s),e.x+=t.x,e.y+=t.y}a.x-=t.x,a.y+=t.y}}addBoundaries(){let t=new c({pos:{x:this.terrainOrigin.x-10*this.floorTileOffset.x,y:8*this.floorTileOffset.y},delta:{x:10*this.floorTileOffset.x,y:10*-this.floorTileOffset.y},normal:r(151)});this.boundaries.push(t);let e=new c({pos:{x:this.terrainOrigin.x+10*this.floorTileOffset.x,y:8*this.floorTileOffset.y},delta:{x:10*-this.floorTileOffset.x,y:10*-this.floorTileOffset.y},normal:r(148)});this.boundaries.push(e);let s=new c({pos:{x:this.terrainOrigin.x+10*this.floorTileOffset.x,y:8.6*this.floorTileOffset.y},delta:{x:10*-this.floorTileOffset.x,y:10*this.floorTileOffset.y},normal:r(152)});this.boundaries.push(s);let i=new c({pos:{x:this.terrainOrigin.x-10*this.floorTileOffset.x,y:8.6*this.floorTileOffset.y},delta:{x:10*this.floorTileOffset.x,y:10*this.floorTileOffset.y},normal:r(155)});this.boundaries.push(i)}addSpawnPoints(){let t=this.terrainOrigin,e=this.floorTileOffset;[{x:t.x,y:t.y-e.y},{x:t.x-9*e.x,y:t.y+8*e.y},{x:t.x+9*e.x,y:t.y+8*e.y},{x:t.x,y:t.y+17*e.y},{x:t.x-4.5*e.x,y:t.y+3.5*e.y},{x:t.x+4.5*e.x,y:t.y+3.5*e.y},{x:t.x+4.5*e.x,y:t.y+12.5*e.y},{x:t.x-4.5*e.x,y:t.y+12.5*e.y}].forEach((t=>{let e=new f({pos:t},this);this.spawnPoints.push(e)}))}addObjects(){this.gameObjects.push(new x({x:this.game.dimx/2-100,y:this.game.dimy/2+50},this)),this.gameObjects.push(new x({x:this.game.dimx/2+100,y:this.game.dimy/2+50},this)),this.gameObjects.push(new x({x:this.game.dimx/2+50,y:this.game.dimy/2+150},this))}}class S{constructor(t,e){this.canvas=t,this.options=e,this.ctx=t.getContext("2d"),this.dimx=t.width,this.dimy=t.height,this.center={x:this.dimx/2,y:this.dimy/2},this.scene=new w(this,e),this.prevTime=Date.now(),this.dt=0,this.run()}run=()=>{let t=Date.now();this.dt=(t-this.prevTime)/1e3,this.prevTime=t,this.scene.run(this.dt),requestAnimationFrame(this.run)};restart(){this.scene=new w(this,this.options)}}window.bgSprites={},window.playerSprites={},window.enemySprites={},window.effectSprites={},window.sounds={};const b=document.getElementById("game-canvas"),k=b.getContext("2d"),v={s:[640,480],m:[800,600],l:[960,720],s169:[800,450],m169:[1040,585],l169:[1280,720]},_=t=>{b.width=v[t][0],b.height=v[t][1]};let O="l169";_(O),k.fillStyle="black",k.fillRect(0,0,b.width,b.height);const T=()=>{const t=document.getElementById("scoreboard");for(;t.firstChild;)t.removeChild(t.firstChild);let e=["s0","s1","s2","s3","s4","s5","s6","s7","s8","s9"];if(localStorage.getItem("s0"))for(let s=0;s<10;s++){let i=localStorage.getItem(e[s]);if(i){0===s&&(i="~~~"+i+"~~~");const e=document.createTextNode(i),h=document.createElement("p");h.appendChild(e),t.appendChild(h)}}else{const e=document.createTextNode("No hi score yet!"),s=document.createElement("p");s.appendChild(e),t.appendChild(s)}};let E,j={scoreBoardCallback:T};(async()=>{await(async()=>(await(async()=>{["ground0","ground1","archway0","wall0","totem_1","totem_2"].forEach((t=>{let e=new Image;e.src=`./assets/background/${t}.png`,bgSprites[t]=e}))})(),await(async()=>{let t=["attack_1","attack_2","attack_3","idle","move_1","move_2","move_3","move_4","strafe_1","strafe_2","strafe_3","heal_1","heal_2","heal_3","heal_4"];[148,65,152,87,155,68,151,83].forEach((e=>{playerSprites[e]={},t.forEach((t=>{let s=new Image;s.src=`./assets/player/${e}/${t}.png`,playerSprites[e][t]=s}))}))})(),await(async()=>{let t=["attack_1","attack_2","attack_3","attack_4","idle","move_1","move_2","death_1","death_2","death_3","death_4"];[148,65,152,87,155,68,151,83].forEach((e=>{enemySprites[e]={},t.forEach((t=>{let s=new Image;s.src=`./assets/enemy/${e}/${t}.png`,enemySprites[e][t]=s}))}))})(),await(async()=>{["spawn_1","spawn_2","spawn_3","block_1","block_2","block_3","hit_1","hit_2","hit_3"].forEach((t=>{let e=new Image;e.src=`./assets/effects/${t}.png`,effectSprites[t]=e}))})(),!0))(),E=new S(b,j)})(),document.getElementById("resize-button").addEventListener("click",(()=>{switch(O){case"s169":O="m169";break;case"m169":O="l169";break;case"l169":O="s169"}_(O),E=new S(b,j)})),T()})();